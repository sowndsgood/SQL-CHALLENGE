--Calculate the total revenue loss due to discounts applied

-- Orders Table 
CREATE TABLE orders (
 order_id BIGINT, --Use BIGINT instead of INT64
 order_date DATE,
 product_id BIGINT,  --Use BIGINT instead of INT64
 quantity BIGINT, --Use BIGINT instead of INT64
 price_per_unit FLOAT, --Use FLOAT instead of FLOAT64
 discount_percentage FLOAT --Use FLOAT instead of FLOAT64
);

-- Sample Data for Orders Table 
INSERT INTO orders VALUES
(1, '2024-01-10', 101, 2, 500, 10),
(2, '2024-01-15', 102, 1, 1000, 20),
(3, '2024-01-18', 103, 3, 200, 0),
(4, '2024-01-20', 104, 5, 150, 15),
(5, '2024-02-01', 105, 2, 300, 5),
(6, '2024-02-10', 101, 1, 500, 25);

SELECT * FROM ORDERS;

PREPARE SIMPLE_QUERY (DATE, DATE, NUMERIC) AS
SELECT 
COUNT(ORDER_ID) AS TOTAL_ORDERS,
SUM (QUANTITY*PRICE_PER_UNIT) AS TOTAL_REVENUE,
SUM (QUANTITY*PRICE_PER_UNIT*(DISCOUNT_PERCENTAGE/100)) AS REVENUE_LOSS,
SUM (QUANTITY*PRICE_PER_UNIT)-SUM (QUANTITY*PRICE_PER_UNIT*(DISCOUNT_PERCENTAGE/100)) AS ADJUSTED_REVENUE
FROM ORDERS
WHERE ORDER_DATE BETWEEN $1 AND $2 AND DISCOUNT_PERCENTAGE>= $3 ;

EXECUTE SIMPLE_QUERY('2024-01-01','2024-02-01',10)


